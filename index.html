<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Todo Lista - Tareas Generales</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 min-h-screen flex flex-col">

  <header class="bg-blue-600 text-white py-6 text-center">
    <h1 class="text-3xl font-bold">Todo Lista - Tareas Generales</h1>
  </header>

  <main class="flex-1 p-6 max-w-4xl mx-auto w-full">

    <form id="task-form" class="flex flex-col gap-4 mb-6">
      <input type="text" id="task-input" placeholder="Escribe una tarea..." required class="w-full p-3 rounded border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400">

      <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold p-3 rounded transition">
        Agregar tarea
      </button>
    </form>

    <ul id="task-list" class="space-y-6">
      <!-- Tareas aparecerán acá -->
    </ul>

  </main>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzEwmV1Jp1cb-k6doJK_gPlqV96L_euMjv8I64rbxqVCG8RCd045bU-SKt2bWKY5vaoww/exec"; // ← Pega aquí tu URL real

const taskForm = document.getElementById('task-form');
const taskInput = document.getElementById('task-input');
const taskList = document.getElementById('task-list');

async function addTaskToSheet(taskName) {
  try {
    await fetch(API_URL, {
      method: 'POST',
      body: JSON.stringify({ name: taskName, status: "Pendiente" }),
      headers: { 'Content-Type': 'application/json' }
    });
  } catch (error) {
    console.error('Error al guardar tarea:', error);
  }
}

async function loadTasks() {
  try {
    const response = await fetch(API_URL);
    const tasks = await response.json();

    taskList.innerHTML = ''; // Limpiar lista

    tasks.forEach((task, index) => {
      const li = document.createElement('li');
      li.className = "bg-white p-4 rounded shadow flex justify-between items-center";
      li.innerHTML = `
        <div>
          <span class="font-semibold">${task.name}</span>
          <span class="ml-4 text-gray-500 text-sm">[${task.status}]</span>
        </div>
      `;
      taskList.appendChild(li);
    });
  } catch (error) {
    console.error('Error al cargar tareas:', error);
  }
}

taskForm.addEventListener('submit', async (e) => {
  e.preventDefault();
  const taskName = taskInput.value.trim();
  if (taskName) {
    await addTaskToSheet(taskName);
    taskInput.value = '';
    await loadTasks(); // Actualizar la lista después de agregar
  }
});

// Cargar tareas al abrir la página
loadTasks();
</script>

</body>
</html>
