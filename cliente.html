<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Cliente - Ver Tareas</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 min-h-screen flex flex-col">

  <div id="login" class="flex-1 flex items-center justify-center p-6">
    <div class="bg-white p-8 rounded shadow-md w-full max-w-sm text-center">
      <h2 class="text-2xl font-bold mb-6">Acceso de Cliente</h2>
      <input type="password" id="password" placeholder="Contraseña" class="w-full p-3 mb-4 rounded border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400">
      <button onclick="checkPassword()" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold p-3 rounded w-full">Ingresar</button>
      <p id="error" class="text-red-500 text-sm mt-4 hidden">Contraseña incorrecta. Inténtalo de nuevo.</p>
    </div>
  </div>

  <main id="task-page" class="flex-1 p-6 max-w-4xl mx-auto w-full space-y-6 hidden">
    <header class="bg-blue-600 text-white py-6 text-center rounded">
      <h1 class="text-3xl font-bold">Progreso de Tareas</h1>
    </header>
    <div id="task-container" class="mt-6">
      <!-- Las tareas aparecerán aquí -->
    </div>
  </main>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzEwmV1Jp1cb-k6doJK_gPlqV96L_euMjv8I64rbxqVCG8RCd045bU-SKt2bWKY5vaoww/exec"; // Pega aquí tu API

const CORRECT_PASSWORD = "moldesa123"; // ← La contraseña que quieras usar

function checkPassword() {
  const inputPassword = document.getElementById('password').value;
  const errorMsg = document.getElementById('error');

  if (inputPassword === CORRECT_PASSWORD) {
    document.getElementById('login').classList.add('hidden');
    document.getElementById('task-page').classList.remove('hidden');
    renderClientTasks();
  } else {
    errorMsg.classList.remove('hidden');
  }
}

function getProgressByStatus(status) {
  switch(status) {
    case "Pendiente": return {percent: 25, color: "bg-blue-600"};
    case "Haciendo": return {percent: 50, color: "bg-yellow-400"};
    case "Pausado": return {percent: 75, color: "bg-orange-500"};
    case "Terminado": return {percent: 100, color: "bg-green-500"};
    default: return {percent: 0, color: "bg-gray-400"};
  }
}

async function renderClientTasks() {
  const response = await fetch(API_URL);
  const tasks = await response.json();
  const taskContainer = document.getElementById('task-container');

  if (tasks.length === 0) {
    taskContainer.innerHTML = "<p class='text-center text-gray-500'>No hay tareas agregadas.</p>";
    return;
  }

  taskContainer.innerHTML = '';

  tasks.forEach(task => {
    const {percent, color} = getProgressByStatus(task.status);

    const div = document.createElement('div');
    div.className = "bg-white p-6 rounded shadow";

    div.innerHTML = `
      <h2 class="text-xl font-semibold mb-4">${task.name}</h2>
      <div class="w-full bg-gray-200 rounded-full h-4 mb-4">
        <div class="${color} h-4 rounded-full" style="width: ${percent}%"></div>
      </div>
      <p class="text-gray-700 font-semibold">Estado: ${task.status}</p>
    `;

    taskContainer.appendChild(div);
  });
}
</script>

</body>
</html>
